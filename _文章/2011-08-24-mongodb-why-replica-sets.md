---
ID: 590
post_title: MongoDB-为什么使用复制
author: riv
post_date: 2011-08-24 17:48:45
post_excerpt: ""
layout: post
permalink: >
  http://snowriver.org/blog/2011/08/24/mongodb-why-replica-sets/
published: true
---
<img alt="" src="http://regularlyexpressed.com/wp-content/uploads/2011/05/db-replication.gif" title="dbreplicate" class="alignright" width="150" height="150" />本文意译自<a href="http://www.mongodb.org/display/DOCS/Why+Replica+Sets">Why Replica Sets</a>
网上有不少如何使用复制的文章，但是对为什么要使用复制却没找到。MongoDB官方文档有对为什么有详细的描述。我就顺手意译一下，因为一字一句的翻译我的能力不够。

复制集和单节点相比有五个优势。如果系统需要这五个特性当中的一个或几个，可以考虑使用复制集。
<ul>
	<li>数据冗余：复制集会将应用数据自动保持多份。支持的驱动允许控制人们所关心的写是否持久问题。由于MongoDB将存储操作交给操作系统处理。至于操作系统多长时间会将数据刷到磁盘中，每个操作系统各有不同，但是一般都会有一定的时间间隔。所以操作返回了，数据并不保证会写到磁盘当中去。采用数据集方式就会将数据保持到多个节点中，以至于一个节点死掉还可以有节点保持数据。</li>
	<li>自动故障恢复：复制集会协调是在一个集合中只有一个主节点。驱动会检测到集合中主节点的变化。在大部分情况下，这意味着客户端能够自动处理主节点失败，而不需要修改任何配置。从冷备份恢复通常会是一个相当耗时的操作。冷备份还有可能会导致数据丢失，因为备份会有一个时间间隔，这段时间的数据就有可能丢失了。而复制集相当于提供一个热备份，这通常会比冷备份更快，数据丢失也会更少。</li>
	<li>读伸缩性：缺省情况下，所有的读写操作只会访问复制集当中的主节点。但是大部分驱动都提供一个slaveOkay的方式，用于指定特定操作可以在次节点执行。当使用slaveOkay时，读操作可以在多个节点之间共享。这种模式适合在单次写多次读时使用。</li>
	<li>维护性：当系统升级、压缩、备份时，经常需要从系统中移除一个节点。复制集允许这样的操作在生产环境中使用。只要生产环境能够忍受移除单个节点就可以了，而是否能够忍受可以通过部署方案来实现。这也可以使系统可以实现象滚动升级这样的特性。</li>
	<li>灾难恢复：复制集允许延迟副节点。操作在这个副节点上会延迟一段时间。这使在一些灾难时间时有一个恢复窗口时间，如错误的部署、删除了集合。</li>
</ul>